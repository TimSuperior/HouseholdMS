<Window x:Class="HouseholdMS.View.Dashboard.IrradianceDetailsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Irradiance Details" WindowStartupLocation="CenterOwner"
        MinWidth="820" MinHeight="520">
    <DockPanel Margin="12">
        <!-- Header -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,10">
            <TextBlock Text="⭘  Irradiance (Fast mode: Open-Meteo)"
                       FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
            <Button Content="Refresh" Margin="12,0,0,0" Padding="10,4"
                    Click="Refresh_Click" VerticalAlignment="Center"/>
            <TextBlock x:Name="LocText" Margin="16,0,0,0" Foreground="#666"
                       VerticalAlignment="Center"/>
        </StackPanel>

        <!-- Hint -->
        <TextBlock DockPanel.Dock="Top" Margin="0,0,0,6"
                   Text="Last 7 days + next 3 days • GHI in kWh/m² • Peak only for forecast days"
                   Foreground="#666"/>

        <!-- Summary line -->
        <TextBlock x:Name="SummaryText"
                   DockPanel.Dock="Top"
                   Margin="0,0,0,12"
                   Foreground="#444"/>

        <!-- Content -->
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel>

                <!-- ===== PAST ===== -->
                <Border Background="#FAFAFC" BorderBrush="#E6E8EF" BorderThickness="1"
                        CornerRadius="10" Padding="10" Margin="0,0,0,12">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <Ellipse Width="8" Height="8" Fill="#4F46E5" VerticalAlignment="Center"/>
                            <TextBlock Text="  Past 7 days" FontWeight="SemiBold" FontSize="14"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <DataGrid x:Name="PastGrid"
                                  AutoGenerateColumns="False"
                                  IsReadOnly="True"
                                  HeadersVisibility="Column"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  SelectionMode="Single"
                                  GridLinesVisibility="Horizontal"
                                  RowHeaderWidth="0"
                                  EnableRowVirtualization="True"
                                  EnableColumnVirtualization="True"
                                  AlternatingRowBackground="#FFF7F7FA"
                                  AlternationCount="2">
                            <DataGrid.Resources>
                                <!-- Compact cells -->
                                <Style TargetType="DataGridCell">
                                    <Setter Property="Padding" Value="8,4"/>
                                </Style>
                                <!-- Header look -->
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#F3F4F6"/>
                                    <Setter Property="BorderBrush" Value="#E5E7EB"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="Padding" Value="8,6"/>
                                </Style>
                                <!-- Text blocks in cells -->
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                </Style>
                                <Style x:Key="RightCell" TargetType="TextBlock">
                                    <Setter Property="TextAlignment" Value="Right"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                </Style>
                            </DataGrid.Resources>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Date (UTC)" Binding="{Binding Date}" MinWidth="110"/>
                                <DataGridTextColumn Header="GHI (kWh/m²)" Binding="{Binding GhiKwhm2}"
                                                    ElementStyle="{StaticResource RightCell}" MinWidth="130"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>

                <!-- ===== FORECAST ===== -->
                <Border Background="#FAFAFC" BorderBrush="#E6E8EF" BorderThickness="1"
                        CornerRadius="10" Padding="10">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <Ellipse Width="8" Height="8" Fill="#059669" VerticalAlignment="Center"/>
                            <TextBlock Text="  Forecast (next 3 days)" FontWeight="SemiBold" FontSize="14"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <DataGrid x:Name="ForecastGrid"
                                  AutoGenerateColumns="False"
                                  IsReadOnly="True"
                                  HeadersVisibility="Column"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  SelectionMode="Single"
                                  GridLinesVisibility="Horizontal"
                                  RowHeaderWidth="0"
                                  EnableRowVirtualization="True"
                                  EnableColumnVirtualization="True"
                                  AlternatingRowBackground="#FFF7F7FA"
                                  AlternationCount="2">
                            <DataGrid.Resources>
                                <!-- Compact cells -->
                                <Style TargetType="DataGridCell">
                                    <Setter Property="Padding" Value="8,4"/>
                                </Style>
                                <!-- Header look -->
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#F3F4F6"/>
                                    <Setter Property="BorderBrush" Value="#E5E7EB"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="Padding" Value="8,6"/>
                                </Style>
                                <!-- Text blocks in cells -->
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                </Style>
                                <Style x:Key="RightCell" TargetType="TextBlock">
                                    <Setter Property="TextAlignment" Value="Right"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                </Style>
                            </DataGrid.Resources>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Date (UTC)" Binding="{Binding Date}" MinWidth="110"/>
                                <DataGridTextColumn Header="GHI (kWh/m²)" Binding="{Binding GhiKwhm2}"
                                                    ElementStyle="{StaticResource RightCell}" MinWidth="130"/>
                                <DataGridTextColumn Header="Peak (W/m²)" Binding="{Binding PeakWm2}"
                                                    ElementStyle="{StaticResource RightCell}" MinWidth="120"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>
    </DockPanel>
</Window>
